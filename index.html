<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Token einlösen</title>
    <script src="sendTokenSubmission.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>

    <main>
        <h1><span>Token</span> einlösen</h1>
        <div class="text-container">
            <p>Willkommen bei Artis-Mea! </p>
            <p>Gib bitte deinen Benutzernamen und den Token ein, um auf dem Netzwerk zur Whitelist hinzugefügt zu werden.</p>
        </div>
        <hr>
        <div>
            <form id="tokenForm">
                <label for="name"></label>
                <input type="text" id="name" placeholder="Minecraft-Name" required>
                <label for="token"></label>
                <input type="text" id="token" placeholder="Token" required>
                <input type="submit" value="Einlösen" id="submit">
            </form>
        </div>
    </main>

    <script>
        document.getElementById('tokenForm').addEventListener('submit', async function (e) {
          e.preventDefault();

          const name = document.getElementById('name').value;
          const token = document.getElementById('token').value;

          document.getElementById('submit').classList.add('loading');
          
          const response = await sendTokenSubmission(name, token);

          if (!response) {
            window.location.href = "./failed/";

          } else if (response.token === token) {
            window.location.href = "./success/";

          } else {

            switch (response.type) {
              case 1:
                window.location.href = "./failed/invalid-or-used";
                break;
              case 2:
                window.location.href = "./failed/already-whitelisted";
                break;
              default:
                window.location.href = "./failed/";
                break;
            }

          }
        });
    </script>

</body>
</html>